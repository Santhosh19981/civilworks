<ion-header [translucent]="true">
    <ion-toolbar>
        <ion-title>My Orders</ion-title>
    </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
    <ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
        <ion-refresher-content></ion-refresher-content>
    </ion-refresher>

    <!-- Orders List -->
    <div *ngIf="!loading && orders.length > 0">
        <ion-card *ngFor="let order of orders" class="order-card">
            <ion-card-header>
                <div class="order-header">
                    <div>
                        <ion-card-subtitle>Order ID</ion-card-subtitle>
                        <ion-card-title class="order-id">{{ order.id }}</ion-card-title>
                    </div>
                    <div class="order-status" [ngClass]="getStatusClass(order.status)">
                        <ion-icon [name]="getStatusIcon(order.status)"></ion-icon>
                        {{ order.status }}
                    </div>
                </div>
            </ion-card-header>

            <ion-card-content>
                <div class="order-info">
                    <div class="info-row">
                        <ion-icon name="calendar"></ion-icon>
                        <span>{{ order.date | date:'medium' }}</span>
                    </div>
                    <div class="info-row">
                        <ion-icon name="cube"></ion-icon>
                        <span>{{ order.items.length }} item(s)</span>
                    </div>
                    <div class="info-row">
                        <ion-icon name="card"></ion-icon>
                        <span>{{ order.paymentMethod === 'cod' ? 'Cash on Delivery' : 'Online Payment' }}</span>
                    </div>
                </div>

                <!-- Status Timeline -->
                <div class="status-timeline-mini">
                    <div class="timeline-step"
                        [class.active]="order.status === 'Packing' || order.status === 'Shipping' || order.status === 'Delivered'">
                        <div class="step-dot"></div>
                        <span>Packing</span>
                    </div>
                    <div class="timeline-line"
                        [class.active]="order.status === 'Shipping' || order.status === 'Delivered'"></div>
                    <div class="timeline-step"
                        [class.active]="order.status === 'Shipping' || order.status === 'Delivered'">
                        <div class="step-dot"></div>
                        <span>Shipping</span>
                    </div>
                    <div class="timeline-line" [class.active]="order.status === 'Delivered'"></div>
                    <div class="timeline-step" [class.active]="order.status === 'Delivered'">
                        <div class="step-dot"></div>
                        <span>Delivered</span>
                    </div>
                </div>

                <div class="order-total">
                    <span>Total Amount</span>
                    <span class="total-amount">â‚¹{{ order.total }}</span>
                </div>
            </ion-card-content>
        </ion-card>
    </div>

    <!-- Skeleton Loaders -->
    <div *ngIf="loading">
        <ion-card *ngFor="let i of [1,2,3]">
            <ion-card-content>
                <ion-skeleton-text [animated]="true"
                    style="width: 60%; height: 24px; margin-bottom: 12px;"></ion-skeleton-text>
                <ion-skeleton-text [animated]="true"
                    style="width: 40%; height: 20px; margin-bottom: 8px;"></ion-skeleton-text>
                <ion-skeleton-text [animated]="true" style="width: 100%; height: 80px;"></ion-skeleton-text>
            </ion-card-content>
        </ion-card>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="!loading && orders.length === 0">
        <div class="empty-state-icon">ðŸ“¦</div>
        <div class="empty-state-title">No Orders Yet</div>
        <div class="empty-state-text">Start shopping to see your orders here</div>
        <ion-button expand="block" class="cta-button" (click)="navigateToHome()">
            Start Shopping
        </ion-button>
    </div>
</ion-content>