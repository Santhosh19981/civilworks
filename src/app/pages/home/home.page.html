<ion-header [translucent]="true">
    <ion-toolbar>
        <ion-title>
            <div class="header-title">
                <ion-icon name="hammer" color="primary"></ion-icon>
                <span>CivilWorks</span>
            </div>
        </ion-title>
        <ion-buttons slot="end">
            <ion-button routerLink="/cart" class="cart-button">
                <ion-icon slot="icon-only" name="cart-outline"></ion-icon>
                <ion-badge *ngIf="cartCount > 0" class="cart-badge">{{ cartCount }}</ion-badge>
            </ion-button>
        </ion-buttons>
    </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
    <ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
        <ion-refresher-content></ion-refresher-content>
    </ion-refresher>

    <!-- Banner Carousel -->
    <div class="banner-carousel">
        <div class="banner-slides" [style.transform]="'translateX(-' + (currentSlide * 100) + '%)'">
            <div class="banner-slide" *ngFor="let banner of banners">
                <img [src]="banner.image" [alt]="banner.title">
                <div class="banner-overlay">
                    <h2>{{ banner.title }}</h2>
                </div>
            </div>
        </div>
        <div class="banner-indicators">
            <span *ngFor="let banner of banners; let i = index" class="indicator" [class.active]="i === currentSlide">
            </span>
        </div>
    </div>

    <!-- CTA Buttons -->
    <div class="cta-section">
        <ion-button expand="block" class="cta-button" (click)="navigateToBuy()">
            <ion-icon slot="start" name="cube"></ion-icon>
            Buy Construction Materials
        </ion-button>
        <ion-button expand="block" class="cta-button-secondary" (click)="navigateToRental()">
            <ion-icon slot="start" name="construct"></ion-icon>
            Rent Heavy Equipment
        </ion-button>
    </div>

    <!-- Featured Products -->
    <div class="section-header">
        <h2 class="section-title">Featured Products</h2>
        <a class="section-link" (click)="viewAllProducts()">View All →</a>
    </div>

    <div class="horizontal-scroll" *ngIf="!loading">
        <div class="horizontal-scroll-item" *ngFor="let product of featuredProducts" (click)="viewProduct(product.id)">
            <div class="product-card">
                <img [src]="product.image" [alt]="product.name" class="product-image">
                <div class="product-info">
                    <div class="product-name">{{ product.name }}</div>
                    <div class="product-price">₹{{ product.price }}</div>
                    <div class="product-category">{{ product.category }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Skeleton Loaders for Products -->
    <div class="horizontal-scroll" *ngIf="loading">
        <div class="horizontal-scroll-item" *ngFor="let i of [1,2,3,4,5,6]">
            <div class="skeleton-card">
                <ion-skeleton-text [animated]="true"
                    style="width: 100%; height: 180px; border-radius: 8px;"></ion-skeleton-text>
                <ion-skeleton-text [animated]="true" style="width: 80%; margin-top: 8px;"></ion-skeleton-text>
                <ion-skeleton-text [animated]="true" style="width: 40%; margin-top: 4px;"></ion-skeleton-text>
            </div>
        </div>
    </div>

    <!-- Popular Rentals -->
    <div class="section-header">
        <h2 class="section-title">Popular Rentals</h2>
        <a class="section-link" (click)="viewAllRentals()">View All →</a>
    </div>

    <div class="horizontal-scroll" *ngIf="!loading">
        <div class="horizontal-scroll-item" *ngFor="let rental of popularRentals" (click)="viewRental(rental.id)">
            <div class="product-card">
                <img [src]="rental.image" [alt]="rental.name" class="product-image">
                <div class="product-info">
                    <div class="product-name">{{ rental.name }}</div>
                    <div class="product-price">₹{{ rental.pricePerDay }}/day</div>
                    <div class="product-category">{{ rental.category }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Skeleton Loaders for Rentals -->
    <div class="horizontal-scroll" *ngIf="loading">
        <div class="horizontal-scroll-item" *ngFor="let i of [1,2,3,4,5,6]">
            <div class="skeleton-card">
                <ion-skeleton-text [animated]="true"
                    style="width: 100%; height: 180px; border-radius: 8px;"></ion-skeleton-text>
                <ion-skeleton-text [animated]="true" style="width: 80%; margin-top: 8px;"></ion-skeleton-text>
                <ion-skeleton-text [animated]="true" style="width: 40%; margin-top: 4px;"></ion-skeleton-text>
            </div>
        </div>
    </div>

    <div style="height: 24px;"></div>
</ion-content>