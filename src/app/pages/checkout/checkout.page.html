<ion-header [translucent]="true">
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-button (click)="goBack()">
                <ion-icon slot="icon-only" name="arrow-back"></ion-icon>
            </ion-button>
        </ion-buttons>
        <ion-title>Checkout</ion-title>
    </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
    <div class="checkout-container">
        <h2 class="section-title"> Delivery Address</h2>

        <form [formGroup]="checkoutForm">
            <ion-item lines="none" class="input-item" [class.ion-invalid]="name?.invalid && name?.touched">
                <ion-label position="stacked">Full Name *</ion-label>
                <ion-input formControlName="name" type="text" placeholder="Enter your full name"></ion-input>
            </ion-item>
            <div class="error-message" *ngIf="name?.invalid && name?.touched">
                {{ getErrorMessage('name') }}
            </div>

            <ion-item lines="none" class="input-item" [class.ion-invalid]="phone?.invalid && phone?.touched">
                <ion-label position="stacked">Phone Number *</ion-label>
                <ion-input formControlName="phone" type="tel" maxlength="10"
                    placeholder="10-digit mobile number"></ion-input>
            </ion-item>
            <div class="error-message" *ngIf="phone?.invalid && phone?.touched">
                {{ getErrorMessage('phone') }}
            </div>

            <ion-item lines="none" class="input-item"
                [class.ion-invalid]="addressLine1?.invalid && addressLine1?.touched">
                <ion-label position="stacked">Address Line 1 *</ion-label>
                <ion-input formControlName="addressLine1" type="text"
                    placeholder="House/Flat No, Building Name"></ion-input>
            </ion-item>
            <div class="error-message" *ngIf="addressLine1?.invalid && addressLine1?.touched">
                {{ getErrorMessage('addressLine1') }}
            </div>

            <ion-item lines="none" class="input-item">
                <ion-label position="stacked">Address Line 2</ion-label>
                <ion-input formControlName="addressLine2" type="text"
                    placeholder="Street, Area, Landmark (Optional)"></ion-input>
            </ion-item>

            <div class="form-row">
                <div class="form-col">
                    <ion-item lines="none" class="input-item" [class.ion-invalid]="city?.invalid && city?.touched">
                        <ion-label position="stacked">City *</ion-label>
                        <ion-input formControlName="city" type="text" placeholder="City"></ion-input>
                    </ion-item>
                    <div class="error-message" *ngIf="city?.invalid && city?.touched">
                        {{ getErrorMessage('city') }}
                    </div>
                </div>

                <div class="form-col">
                    <ion-item lines="none" class="input-item" [class.ion-invalid]="state?.invalid && state?.touched">
                        <ion-label position="stacked">State *</ion-label>
                        <ion-input formControlName="state" type="text" placeholder="State"></ion-input>
                    </ion-item>
                    <div class="error-message" *ngIf="state?.invalid && state?.touched">
                        {{ getErrorMessage('state') }}
                    </div>
                </div>
            </div>

            <ion-item lines="none" class="input-item">
                <ion-label position="stacked">Pincode *</ion-label>
                <ion-input formControlName="pincode" type="text" maxlength="6" placeholder="6-digit pincode"
                    inputmode="numeric"></ion-input>
            </ion-item>
        </form>

        <!-- Order Summary -->
        <div class="summary-card">
            <h3 class="summary-title">ðŸ“‹ Order Summary</h3>
            <div class="summary-content">
                <div class="summary-row">
                    <span>Items ({{ itemCount }})</span>
                    <span>â‚¹{{ total }}</span>
                </div>
                <div class="summary-row">
                    <span>Delivery</span>
                    <span class="free-text">FREE</span>
                </div>
                <div class="summary-divider"></div>
                <div class="summary-row total-row">
                    <span>Total Amount</span>
                    <span>â‚¹{{ total }}</span>
                </div>
            </div>
        </div>
    </div>
</ion-content>

<ion-footer>
    <ion-toolbar>
        <ion-button expand="block" class="cta-button" (click)="proceedToPayment()" [disabled]="!checkoutForm.valid">
            <ion-icon slot="start" name="card"></ion-icon>
            Continue to Payment
        </ion-button>
    </ion-toolbar>
</ion-footer>